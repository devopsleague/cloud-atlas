.. _desktop_base_os:

===================
桌面基础操作系统
===================

在 :ref:`base_os` 的解析中，基于我的数次部署经验，我强烈推荐采用Ubuntu Server LTS发行版来构建基础操作系统。

不过，如果你的硬件对Linux支持良好（例如通用的PC），并且你没有空闲的计算机硬件来部署服务器版本，你可能会考虑在自己的桌面笔记本上部署基础操作系统。此时，你需要选择一个合适的桌面操作系统。

选择考虑:

- 轻量级图形界面 -- 既不会因为追求酷炫的图形效果白白浪费了有限的计算资源，也不会因为简陋而无法支持基本的图形应用程序。
- 支持主流的硬件 -- 需要较新的主流Linux内核，确保硬件驱动工作顺畅
- 适当的稳定性 -- 确保发行版已经得到充分验证

发行版选择
==================

选择操作系统发行版依然和 :ref:`base_os` 相同，综合考虑内核足够稳定和新颖，选择 4.x 系列内核的Ubuntu Desktop系列，这样对于企业级应用友好，很多商业软件都有Ubuntu软件包。

另一种选择是完全依赖开源社区，推荐使用Arch Linux滚动发行版本。主要的优势类似Gentoo可以使用最新的内核以及开源软件。缺点是在运行商业软件时需要较多的hack。

在 :ref:`thinkpad_x220` 上我尝试过 Xubuntu ，依然觉得不够满意(折腾)。所以切换到Arch Linux作为桌面。

版本选择
==============

.. note::

   由于 :ref:`nvidia-docker` 需要在Ubuntu LTS上构建，所以，为了能够稳定和尽可能避免应用兼容性问题，强烈建议在Desktop环境依然采用LTS系列版本。不过，如果你想体验更新更酷的前沿技术，依然可以选择release版本，只是会在硬件相关的问题上更多折腾。

在Ubuntu的具体版本号上，选择 Xubuntu 18.4 LTS:

- 我个人非常反感Gnome和KDE大而全的体系，虽然已经达到了接近macOS和Windows的水平，但是很多功能并不是我（专注服务器技术）所需要的，白白浪费了系统资源，所以我放弃使用标准Ubuntu或者Kubuntu发行版
-  ``Budgie`` 桌面是目前非常火而且简洁美观的发行版，但是我对比了 ``Xfce4`` 和 ``Budgie`` 桌面，发现实际上还是 ``Xfce4`` 占用的资源较少，甚至只有后者的一半。为了能够节约资源，忍痛放弃 ``Budgie`` 。
- 建议采用 Xubuntu 或者 LXQT 发行版，原因是这两种桌面都非常轻量级，而且都支持Gnome和KDE应用程序。不过，我个人比较倾向Xfce桌面，因为其更偏向类似传统的Unix环境。
- 建议直接使用 Xubuntu 安装，而不是自己定制Ubuntu来安装xfce4环境。我尝试过在Ubuntu Server版本上通过安装 ``xfce4`` 软件包来组件最小化Xfce，但是发现实际上要通过删减组件来降低系统消耗会带来很多意想不到的依赖问题。毕竟发行版经过了大量的测试和修复，短时间内自己手工定制桌面不现实。

.. note::

   我的实践因为侧重服务器技术，并且多次实践发现要完美解决MacBook运行Ubuntu Desktop依然有不小的挑战（主要是休眠和节电比较难解决），所以在MacBook Pro上我最终采用的是 Ubuntu Server发型版。

   在 :ref:`thinkpad_x220` 硬件平台，由于是通用笔记本电脑，并且ThinkPad对Linux支持较好，整个硬件体系都有完善对开源支持，所以采用Ubuntu Desktop + Xfce4 来构建。也可以直接采用Xubuntu发行版。

   不过，考虑到X220笔记本硬件对开源友好，同时为了尽可能发挥硬件性能，我最终采用 Arch Linux 发行版来运行。 

桌面选择-Xfce4
===================

.. note::

   实际进过多次测试，我最终是采用字符终端方式运行Ubuntu Server版本

选择考虑:

- 轻量级：占用较少的Host主机资源
- 兼容性：兼容Gnome应用程序（目前主流的桌面应用大多基于Gnome）
- 简洁美观：不需要花哨，但是类似现代iOS和Android这样的干净交互界面

Budgie
--------------

尝试过选择 `budgie <https://ubuntubudgie.org>`_ :

- 在Gnome基础上做了精简，舍弃了Gnome shell，但是能够兼容运行Gnome程序
- 界面采用平面化设计，吸收了Android的设计理念，非常雅致；支持类似macOS的dark theme
- 占用内存较少，我采用mini安装（默认只安装Firefox浏览器），初始安装启动后内存占用只有不到700M

.. note::

   但最终还是回到Xfce，因为发现budgie占用内存还是远超了Xfce。在Xfce中，即使启动了libvirtd/Docker服务，内存也只占用400M。我决定把尽可能多的资源用于虚拟化和计算。
